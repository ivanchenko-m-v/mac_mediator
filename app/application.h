/// ============================================================================
///		Author		: M. Ivanchenko
///		Date create	: 10-10-2013
///		Date update	: 18-12-2013
///		Comment		:
/// ============================================================================
#ifndef __APPLICATION_H__
#define __APPLICATION_H__

#include <QApplication>
#include <QTranslator>

#include "application_params.h"
#include "business_logic.h"

#include "data_adapter_mediator.h"

namespace mac_mediator
{

	class business_logic;
/// ############################################################################
///			class application
/// ############################################################################
	class application : public QApplication
	{
	Q_OBJECT
	/// ========================================================================
	///		CONSTRUCTORS/DESTRUCTOR
	/// ========================================================================
	private:
	/// ------------------------------------------------------------------------
		application( const application &rhs );

	public:
	/// ------------------------------------------------------------------------
		explicit application( int & argc, char ** argv );
	/// ------------------------------------------------------------------------
		~application( );

	/// ========================================================================
	///		PROPERTIES
	/// ========================================================================
	private:
	/// ------------------------------------------------------------------------
	/// int_param
        int int_param(const QString &param) const;

	public:
	/// ------------------------------------------------------------------------
	/// id_mediator
        int id_mediator( ) const;
        void id_mediator( int id );
	/// ------------------------------------------------------------------------
	/// id_ad
        int id_ad( ) const;
        void id_ad( int id );
    /// ------------------------------------------------------------------------
    /// mediator
        const data_mediator& authorized_mediator( ) const
        {
            return this->_mediator;
        }

	/// ========================================================================
	///		FUNCTIONS
	/// ========================================================================
	private:
	/// ------------------------------------------------------------------------
		void initialize( );
	/// ------------------------------------------------------------------------
		void load_translation( );
    /// ------------------------------------------------------------------------
        void load_config( );
    /// ------------------------------------------------------------------------
        void find_db_file( );
    /// ------------------------------------------------------------------------
        bool check_db_file();
    /// ------------------------------------------------------------------------
        void init_db( );
    /// ------------------------------------------------------------------------
        void init_logic( );

	public:
	/// ------------------------------------------------------------------------
		static business_logic& the_business_logic( );
    /// ------------------------------------------------------------------------
        static application* program_instance( )
        {
            return static_cast<application*>( QApplication::instance( ) );
        }
    /// ------------------------------------------------------------------------
        void authorize( );

	/// ========================================================================
	///		OPERATORS
	/// ========================================================================
	private:
	/// ------------------------------------------------------------------------
		application& operator=( const application &rhs );

	/// ========================================================================
	///		SLOTS
	/// ========================================================================
	private slots:
    /// ------------------------------------------------------------------------
        void save_config( );

	/// ========================================================================
	///			FIELDS
    /// ========================================================================
    private:
		QTranslator _translator;
		static bool _is_logic_initialized;

        data_mediator _mediator;

        espira::utils::application_params _params;

	};//class application

//#############################################################################
//-----------------------------------------------------------------------------

}//namespace mac_mediator

#endif // __APPLICATION_H__
